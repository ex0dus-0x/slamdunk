# slamdunk

Cloud Storage Bucket Permissions Auditor

## Introduction

`slamdunk` aids webapp hackers to audit cloud storage bucket solutions (currently supports only AWS S3)
to find potential vulnerabilities and leaks that can be disclosed.

## How does it work?

`slamdunk` comprises of a _resolver_ and the main _auditor_. Both work in the following manner:

* The __resolver__ consumes URL(s), say generated by subdomain enumeration, and runs a set of heuristics
to try to figure out the unique bucket name identifier for it. This is useful for asset discovery
for a domain under test, and extrapolated results can be used then for further auditing.

* The __auditor__ consumes bucket name(s) and runs a supported set of actions from a playbook
(see `playbook.go`) to identify what permissions are possible, which can potentially be misused for
privilege escalation or information leaking.

## Usage

To install:

```
$ go get -u github.com/ex0dus-0x/slamdunk
```

### Using the Resolver

You can pass one or more URLs to get started:

```
$ slamdunk resolve --url content.example.com --url images.example.com
+------------------------+--------------------+-----------------+------------------+
|          URL           |    BUCKET NAME     |     REGION      | BUCKET TAKEOVER? |
+------------------------+--------------------+-----------------+------------------+
| content.example.com    |  example-content   |    us-east-2    | false            |
+------------------------+--------------------+-----------------+------------------+
| images.example.com     |  example-img-dev   | No region found | true             |
+------------------------+--------------------+-----------------+------------------+
```

It's more preferable to have a file of URLs seperated by newlines. This can be something you craft yourself with
specific targets, or something you populated with subdomains from ie. [OWASP Amass](https://github.com/OWASP/Amass).

You should also specify an output path to stoe the resultant buckets found, which you can then use for auditing.

```
$ slamdunk resolve --file assets.txt -o buckets.txt
```

### Using the Auditor

You can pass in one or more bucket names to get started:

```
$ slamdunk audit --name example-content --name example-img-dev
```

Or re-use the `buckets.txt` file generated by the resolver:

```
$ slamdunk audit --file buckets.txt
```

By default, all READ-based permissions will be tested, since writing to a potentially vulnerable
and exposed bucket is never really a good idea. However, if you have permission and are ready:

* You can run enable specific actions to also run:

```
$ slamdunk audit --file buckets.txt --enable PutObject --enable PutBucketAcl
```

* ... or run the set of all WRITEs

```
$ slamdunk audit --file buckets.txt --enable-set WRITE
```

* ... or run specific actions _only_:

```
$ slamdunk audit --file buckets.txt --only GetObjects --only PutObject
```

## Playbook

WIP

You can retrieve this with `slamdunk playbook` as well.

## License

[MIT]()
